{% extends "inspectors/employee/index.html" %}
{% load static %}
<!--اسم المستخدم-->
{% block username %}
{{username}}
 {% endblock %}
 {% block username2 %}
 {{username}}
  {% endblock %}

<!--ًصورة المستخدم-->
  {% block profileImg %}
  <img alt="avatar" src="../../../{{img}}" class="rounded-circle">
  {% endblock %}
  {% block profileImg2 %}
  <img alt="avatar" src="../../../{{img}}" class="rounded-circle">
  {% endblock %}

  {% block search %}
  <input type="text" id="search-input" style="border: none; border-radius: 35px; background-color: #f1f1f1; padding: 7px; margin-left: 20px;" placeholder="ابحث ...">
  <div class="btn-group mr-2" role="group">
      <button class="btn btn-primary filter-btn btn-sm" data-filter="جديد">جديد</button>
      <button class="btn btn-primary filter-btn btn-sm" data-filter="مكتمل">مكتمل</button>
      <button class="btn btn-primary filter-btn btn-sm" data-filter="غير مكتمل">غير مكتمل</button>
      <button class="btn btn-primary filter-btn btn-sm" data-filter="معتمد">معتمد</button>
      <button class="btn btn-primary filter-btn btn-sm" data-filter="all">الكل</button>
  </div>

  {% endblock %}
  

{% block clients_home %}

<style>
    .active-filter {
        background-color: #a1cfff;
        color: white;
    }
</style>

   

        <!-- Table -->
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>رقم الطلب</th>
                    <th>الفرع</th>
                    <th>حالة الطلب</th>
                    <th>تاريخ الطلب</th>
                    <th>التقرير</th>
                 
                </tr>
            </thead>
            <!-- <tbody id="ordersTableBody"> -->
                <!-- Orders will be dynamically loaded here -->
                <tbody id="table-body">
                 {% for o in orders %}
                    <tr>
                        <td>HC-AH-{{o.id}}</td>
                        <td>{{o.bransh_id}} - {{o.bransh_id.brand_id}}</td>
                        <td>{% if o.status == '0' %} جديد{% endif %} {% if o.status == '1' %} غير مكتمل{% endif %} {% if o.status == '2' %} مكتمل{% endif %} {% if o.status == '3' %} معتمد{% endif %}</td>
                        <td>{{o.registerDate}}</td>
                        <td><a class="btn btn-sm btn-dark" href="{% url 'evaluate' o.id %}" >فتح</a></td>
                      
                    </tr>
                 {% endfor %}
            </tbody>
        </table>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    

    <script>
        $(document).ready(function() {
            // فلترة الجدول عند الكتابة في حقل البحث
            $('#search-input').on('input', function() {
                let searchText = $(this).val().toLowerCase();
      
                $('#table-body tr').each(function() {
                    // البحث في كل خلية في الصف
                    let rowText = $(this).text().toLowerCase();
                    if (rowText.includes(searchText)) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
            });
      
            // عند الضغط على زر فلترة
            $('.filter-btn').click(function() {
                // استعادة الألوان الافتراضية للأزرار
                $('.filter-btn').removeClass('active-filter');
                
                // إضافة اللون النشط للزر المضغوط
                $(this).addClass('active-filter');
      
                // الحصول على الكلمة المراد البحث عنها
                let filter = $(this).data('filter');
      
                // فلترة الصفوف بناءً على الكلمة المختارة
                $('#table-body tr').each(function() {
                    let rowText = $(this).find('td:eq(2)').text();
                    if (filter === 'all' || rowText.includes(filter)) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
                
                // مسح النص الموجود في حقل البحث
                $('#search-input').val('');
            });
        });
      </script>
    


{% endblock %}